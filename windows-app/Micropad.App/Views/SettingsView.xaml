<Page x:Class="Micropad.App.Views.SettingsView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Settings"
      Background="{StaticResource BackgroundPrimary}">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="Settings" FontSize="24" FontWeight="Bold" 
                      Foreground="{StaticResource TextPrimary}"/>
            <Border Height="3" Width="48" CornerRadius="2" Margin="0,6,0,0"
                    Background="{StaticResource BrandBlue}"/>
        </StackPanel>

        <Border Grid.Row="1" Background="{StaticResource BackgroundSecondary}"
                BorderBrush="{StaticResource BorderColor}" BorderThickness="1"
                CornerRadius="8" Padding="20">
            <StackPanel>
                <!-- Auto Connect -->
                <Grid Margin="0,0,0,20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Auto Connect" FontWeight="Bold" 
                                  Foreground="{StaticResource TextPrimary}" FontSize="14"/>
                        <TextBlock Text="Automatically connect to the last paired device" 
                                  Foreground="{StaticResource TextSecondary}" Margin="0,3,0,0"/>
                    </StackPanel>
                    <CheckBox Grid.Column="1" IsChecked="{Binding AutoConnect}" 
                             VerticalAlignment="Center"/>
                </Grid>

                <!-- Start with Windows -->
                <Grid Margin="0,0,0,20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Start with Windows" FontWeight="Bold" 
                                  Foreground="{StaticResource TextPrimary}" FontSize="14"/>
                        <TextBlock Text="Launch Micropad when Windows starts" 
                                  Foreground="{StaticResource TextSecondary}" Margin="0,3,0,0"/>
                    </StackPanel>
                    <CheckBox Grid.Column="1" IsChecked="{Binding StartWithWindows}" 
                             VerticalAlignment="Center"/>
                </Grid>

                <!-- Minimize to Tray -->
                <Grid Margin="0,0,0,20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Minimize to Tray" FontWeight="Bold" 
                                  Foreground="{StaticResource TextPrimary}" FontSize="14"/>
                        <TextBlock Text="Keep running in system tray when closed" 
                                  Foreground="{StaticResource TextSecondary}" Margin="0,3,0,0"/>
                    </StackPanel>
                    <CheckBox Grid.Column="1" IsChecked="{Binding MinimizeToTray}" 
                             VerticalAlignment="Center"/>
                </Grid>

                <!-- Auto Reconnect -->
                <Grid Margin="0,0,0,20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Auto Reconnect" FontWeight="Bold" 
                                  Foreground="{StaticResource TextPrimary}" FontSize="14"/>
                        <TextBlock Text="Reconnect with exponential backoff when connection is lost" 
                                  Foreground="{StaticResource TextSecondary}" Margin="0,3,0,0"/>
                    </StackPanel>
                    <CheckBox Grid.Column="1" IsChecked="{Binding AutoReconnect}" 
                             VerticalAlignment="Center"/>
                </Grid>

                <!-- Per-app profile switching -->
                <TextBlock Text="Per-app profile switching" FontWeight="Bold" FontSize="14"
                          Foreground="{StaticResource TextPrimary}" Margin="0,15,0,8"/>
                <TextBlock Text="When the foreground app changes, switch to the mapped profile (e.g. Code.exe → Profile 1)."
                          Foreground="{StaticResource TextSecondary}" Margin="0,0,0,10"/>
                <Grid Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBox Grid.Column="0" Text="{Binding NewProcessName}" Margin="0,0,8,0"
                             Background="{StaticResource BackgroundTertiary}"
                             Foreground="{StaticResource TextPrimary}" Padding="8,6"
                             ToolTip="Process name without .exe (e.g. Code, chrome)"/>
                    <TextBox Grid.Column="1" Text="{Binding NewProfileId}" Margin="0,0,8,0"
                             Background="{StaticResource BackgroundTertiary}"
                             Foreground="{StaticResource TextPrimary}" Padding="8,6"
                             ToolTip="Profile ID (0-7)"/>
                    <Button Grid.Column="2" Content="Add" Command="{Binding AddProcessMappingCommand}"
                            Background="{StaticResource AccentBlue}" Foreground="White"
                            Padding="12,6" BorderThickness="0" Cursor="Hand"/>
                </Grid>
                <ListBox ItemsSource="{Binding ProcessProfileMappings}" Margin="0,0,0,0"
                         Background="Transparent" BorderThickness="0"
                         Foreground="{StaticResource TextPrimary}">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Grid Margin="0,4">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" VerticalAlignment="Center">
                                    <Run Text="{Binding Key}"/>
                                    <Run Text=" → Profile " Foreground="{StaticResource TextSecondary}"/>
                                    <Run Text="{Binding Value}"/>
                                </TextBlock>
                                <Button Grid.Column="1" Content="Remove" 
                                        Command="{Binding DataContext.RemoveProcessMappingCommand, RelativeSource={RelativeSource AncestorType=Page}}"
                                        CommandParameter="{Binding Key}"
                                        Background="Transparent" Foreground="{StaticResource Error}"
                                        Padding="6,2" BorderThickness="0" Cursor="Hand"/>
                            </Grid>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </StackPanel>
        </Border>
    </Grid>
</Page>
